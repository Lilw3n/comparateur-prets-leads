jQuery(document).ready(function(t){"use strict";let e=!1;t(".tablenav-pages").find(".current-page").on("focus",function(t){e=!0}).on("blur",function(t){e=!1}),t('select[name="ettsydrop_search_product_id"]').on("change",function(){let a=t(this).closest("form");e||a.find(".current-page").val(1),a.submit()}),t(".tmds-search-product-id").select2({placeholder:"Filter by product",allowClear:!0}),t(".tmds-search-product-id-ajax").select2({closeOnSelect:!0,allowClear:!0,placeholder:"Please enter product title to search",ajax:{url:"admin-ajax.php?action=tmds_search_product_failed_images&tmds_nonce="+tmds_params.nonce,dataType:"json",type:"GET",quietMillis:50,delay:250,data:function(e){return{keyword:e.term,p_id:t(this).closest("td").data("id")}},processResults:function(t){return{results:t}}},escapeMarkup:function(t){return t},minimumInputLength:1});let a=[],n=[],o=!1;t(document).on("click",".tmds-action-download-all",function(){0===t(".tmds-button-all-container").find(".loading").length&&(t(".tmds-action-download").not(".loading").map(function(){0===t(this).closest(".tmds-actions-container").find(".loading").length&&a.push(t(this))}),a.length>0&&(a.shift().click(),t(".tmds-action-download-all").addClass("loading")))}),t(document).on("click",".tmds-action-download",function(){let e=t(this),n=e.closest("tr"),o=e.data("item_id");if(e.hasClass("loading"))return!1;e.addClass("loading"),e.find(".tmds-download-image-error").remove(),t.ajax({url:tmds_params.ajax_url,type:"POST",dataType:"JSON",data:{action:"tmds_download_error_product_images",tmds_nonce:tmds_params.nonce,item_id:o},success:function(a){if(e.removeClass("loading"),"success"===a.status)n.remove(),0===t(".tmds-action-download").length&&t(".tmds-button-all-container").remove();else{let n=t('<span class="tmds-download-image-error dashicons dashicons-no" title="'+a.message+'"></span>');e.append(n)}},error:function(t){console.log(t),e.removeClass("loading")},complete:function(){a.length>0?a.shift().click():t(".tmds-action-download-all").hasClass("loading")&&t(".tmds-action-download-all").removeClass("loading")}})}),t(document).on("click",".tmds-action-delete-all",function(){0===t(".tmds-button-all-container").find(".loading").length&&confirm(tmds_params.i18n_confirm_delete_all)&&(t(".tmds-action-delete").not(".loading").map(function(){0===t(this).closest(".tmds-actions-container").find(".loading").length&&n.push(t(this))}),n.length>0&&(o=!0,n.shift().click(),t(".tmds-action-delete-all").addClass("loading")))}),t(document).on("click",".tmds-action-delete",function(){let e=t(this),a=e.closest("tr"),s=e.data("item_id");e.hasClass("loading")||(o||confirm(tmds_params.i18n_confirm_delete))&&(e.addClass("loading"),e.find(".tmds-delete-image-error").remove(),t.ajax({url:tmds_params.ajax_url,type:"POST",dataType:"JSON",data:{action:"tmds_delete_error_product_images",tmds_nonce:tmds_params.nonce,item_id:s},success:function(n){if(e.removeClass("loading"),"success"===n.status)a.remove(),0===t(".tmds-action-download").length&&t(".tmds-button-all-container").remove();else{let a=t('<span class="tmds-delete-image-error dashicons dashicons-no" title="'+n.message+'"></span>');e.append(a)}},error:function(t){console.log(t),e.removeClass("loading")},complete:function(){n.length>0?n.shift().click():(t(".tmds-action-delete-all").hasClass("loading")&&t(".tmds-action-delete-all").removeClass("loading"),o=!1)}}))})});