jQuery(document).ready(function(e){"use strict";function i(){e(".vifewc-customize-checkbox:not(.vifewc-customize-checkbox-init)").each(function(){e(this).addClass("vifewc-customize-checkbox-init").checkbox(),e(this).on("change",function(){let i=e(this).parent().find('input[type="hidden"]');e(this).prop("checked")?i.val("1"):i.val("");let t=i.attr("data-customize-setting-link");t&&wp.customize(t).set(i.val())})}),e(".vifewc-color:not(.vifewc-color-init)").each(function(){e(this).addClass("vifewc-color-init").css({backgroundColor:e(this).val()}).unbind().minicolors({change:function(i,t){e(this).parent().find(".vifewc-color").css({backgroundColor:i})},animationSpeed:50,animationEasing:"swing",changeDelay:0,control:"wheel",defaultValue:"",format:"rgb",hide:null,hideSpeed:100,inline:!1,keywords:"",letterCase:"lowercase",opacity:!0,position:"bottom left",show:null,showSpeed:100,theme:"default",swatches:[]})}),vifewc_preview_setting.enable||e(".vifewc-deactivate_warning").length||e(".vifewc-sections-wrap").parent().prepend(`<div class="vifewc-warning vifewc-deactivate_warning">${vifewc_preview_text.deactivate_warning}</div>`)}i(),function(){let t=["vifewc","vifewc-customize-section","vifewc-customize-fields"];e.each(t,function(t,c){wp.customize.section(c,function(t){t.expanded.bind(function(t){if(t){switch(c){case"vifewc-customize-fields":let i=e(".vifewc-section-editing").data("section_id")||e(".vifewc-customize-section-add_new").find(".vifewc-customize-section-content-id-value").val()||"";i?(e(document.body).trigger("vifewc_checkout_fields_html",[i]),wp.customize.previewer.send("vifewc_open_section",i)):e(document.body).trigger("vifewc_only_checkout_sections_html");break;case"vifewc-customize-section":e(document.body).trigger("vifewc_checkout_section_html",[e(".vifewc-section-editing").data("section_id")||""]);break;default:e(document.body).trigger("vifewc_only_checkout_sections_html")}i();let t=wp.customize.previewer.previewUrl.get(),n=vifewc_preview_setting.checkout_url;-1===t.indexOf(n)&&wp.customize.previewer.send("vifewc_set_preview_url",n)}})})}),wp.customize.previewer.bind("vifewc_set_preview_url",function(e){e?wp.customize.previewer.previewUrl.set(e):(e=vifewc_preview_setting.checkout_url,wp.customize.previewer.refresh())}),wp.customize.previewer.bind("vifewc_open_section",function(i=""){i||(i=e(".vifewc-section-editing").data("section_id")||e(".vifewc-customize-section-add_new").find(".vifewc-customize-section-content-id-value").val()||""),i&&wp.customize.previewer.send("vifewc_open_section",i)}),e(".customize-section-back").on("click",function(){let i=e(this).parent().parent().parent().prop("id").replace("sub-accordion-section-","");e(".vifewc-section-editing").removeClass("vifewc-section-editing"),t.indexOf(i)>-1&&"vifewc"!==i&&wp.customize.section("vifewc").expanded(!0)})}(),e(document).on("click",".vifewc-popup-close, .vifewc-overlay:not(.vifewc-overlay-loading)",function(i){let t=e(this).closest(".vifewc-popup-wrap");t.hasClass("vifewc-popup-wrap-show")&&t.removeClass("vifewc-popup-wrap-show").addClass("vifewc-popup-wrap-hidden"),e(".vifewc-customize-field-editing").removeClass("vifewc-customize-field-editing"),setTimeout(function(i){e(i).remove()},100,t)}),e(document).on("click",".vifewc-popup-wrap-field-info-bt-save:not(.loading)",function(i){i.preventDefault(),i.stopPropagation();let t=e(this).closest(".vifewc-popup-wrap"),c=t.find(".vifewc-edit-field-section-id").val(),n=t.find(".vifewc-edit-field-id").val(),o=JSON.parse(wp.customize("vifewc_sections_params[section_fields]").get());if(!c||!n)return e(document.body).trigger("villatheme_show_message",["Can not save field data",["error","save-field"],"",!1,4500]),!1;if(t.find(".vifewc-warning-wrap:not(.vifewc-edit-field-option-value):not(.vifewc-edit-field-option-label)").length)return e(document.body).trigger("villatheme_show_message",["Please insert all valid information.",["error","save-field"],"",!1,4500]),!1;o[c]||(o[c]={});let l=t.find(".vifewc-edit-field-save_as").dropdown("get value"),d=t.find(".vifewc-edit-field-meta_key").val()||"";if(l.length&&!d)return e(document.body).trigger("villatheme_show_message",["Meta key name can not be empty.",["error","save-field"],"",!1,4500]),!1;e(this).addClass("loading");let s=o[c][n]||{};if(s.maxlength="",s.max="",s.min="",s.step="",s.save_as=l,s.meta_key=d,t.find("input, select, textarea").each(function(i,t){let c=e(t).attr("name");if(!c||["save_as","meta_key"].includes(c))return!0;e(t).is("select")?(s[c]="validate"===c?[e(t).closest(".dropdown").dropdown("get value")]:e(t).closest(".dropdown").dropdown("get value"),"type"===c&&"datetime"===s[c]&&(s[c]=e(".vifewc-edit-field-time-type").dropdown("get value"))):["class","label_class","input_class"].includes(c)?e(t).val()&&(s[c]=e(t).val().split(",")):s[c]=e(t).val()||""}),["checkbox_group","select","radio"].includes(s.type)){let i,c={},n={},o={},l="checkbox_group"===s.type?[]:"";if(t.find(".vifewc-edit-field-option-wrap .vifewc-warning-wrap").removeClass("vifewc-warning-wrap"),t.find(".vifewc-edit-field-option-wrap").each(function(t,d){let a=e(d).find(".vifewc-edit-field-option-value").val(),v=e(d).find(".vifewc-edit-field-option-label").val();return a||"checkbox_group"!==s.type&&void 0===c[a]?a.indexOf(" ")>-1||a.indexOf('"')>-1||a.indexOf("'")>-1?(e(d).find(".vifewc-edit-field-option-value").addClass("vifewc-warning-wrap"),i=vifewc_preview_text.error_option_value_invalid,!1):c[a]?(e(d).find(".vifewc-edit-field-option-value").addClass("vifewc-warning-wrap"),i=vifewc_preview_text.error_option_value_unique,!1):v?(o[t]=a,c[a]=v,e(d).find(".vifewc-edit-field-option-checkbox").prop("checked")&&("object"==typeof l?l.push(a):l=a),void(n[a]={value:a,label:v,is_selected:e(d).find(".vifewc-edit-field-option-checkbox").prop("checked")?1:""})):(e(d).find(".vifewc-edit-field-option-label").addClass("vifewc-warning-wrap"),i=vifewc_preview_text.error_option_label_empty,!1):(e(d).find(".vifewc-edit-field-option-value").addClass("vifewc-warning-wrap"),i=vifewc_preview_text.error_option_value_empty,!1)}),i)return e(document.body).trigger("villatheme_show_message",[i,["error","edit-field"],"",!1,4500]),e(this).removeClass("loading"),!1;s.options=c,s.vifewc_options=n,s.vifewc_options_id=o,s.default=l}if(o[c][n])o[c][n]=s,e(".vifewc-customize-field-editing").removeClass("vifewc-customize-field-wrap-enable").data("data",s),s.enable?(e(".vifewc-customize-field-editing").addClass("vifewc-customize-field-wrap-enable"),e(".vifewc-customize-field-editing").find(".vifewc-customize-field-disable").addClass("vifewc-hidden"),e(".vifewc-customize-field-editing").find(".vifewc-customize-field-enable").removeClass("vifewc-hidden")):(e(".vifewc-customize-field-editing").find(".vifewc-customize-field-disable").removeClass("vifewc-hidden"),e(".vifewc-customize-field-editing").find(".vifewc-customize-field-enable").addClass("vifewc-hidden")),e(".vifewc-customize-field-editing").find(".vifewc-customize-field-title").html(s.label||d.replace(c+"_","")),s.enable&&s.required&&e(".vifewc-customize-field-editing").find(".vifewc-customize-field-title").append('<span>&nbsp;<abbr class="required">*</abbr></span>'),wp.customize("vifewc_sections_params[section_fields]").set(JSON.stringify(o));else{d===c+"_"&&(d+=s.type+"_"+n.replace(d,"")),s.meta_key=d,o[c][n]=s;let i="";i+=`<div class="vifewc-customize-field-wrap${s.enable?" vifewc-customize-field-wrap-enable":""}">`,i+='<div class="vifewc-customize-field">',i+=`<div class="vifewc-customize-field-title">${s.label||d.replace(c+"_","")}<span>${s.required?'&nbsp;<abbr class="required">*</abbr>':""}</span></div>`,i+='<div class="vifewc-customize-field-action">',i+=`<span class="vifewc-customize-field-edit" title="${vifewc_preview_text.edit}"><i class="icon edit outline"></i></span>`,i+=`<span class="vifewc-customize-field-clone" title="${vifewc_preview_text.clone}"><i class="icon clone outline"></i></span>`,i+=`<span class="vifewc-customize-field-remove" title="${vifewc_preview_text.remove}"><i class="icon trash alternate outline"></i></span>`,i+=`<span class="vifewc-customize-field-enable${s.enable?"":" vifewc-hidden"}" title="${vifewc_preview_text.disable}"><i class="dashicons dashicons-visibility"></i></span>`,i+=`<span class="vifewc-customize-field-disable${s.enable?" vifewc-hidden":""}" title="${vifewc_preview_text.enable}"><i class="dashicons dashicons-hidden"></i></span>`,i+="</div></div></div>",i=e(i),i.data({id:n,data:s}),e(".vifewc-customize-fields").append(i),e(document.body).trigger("vifewc_checkout_fields_sortable")}setTimeout(function(){e(".vifewc-popup-close").trigger("click")},100)}),e(document.body).on("vifewc_popup_checkout_field_validation_min_max",function(i){e('.vifewc-edit-field-type-info-wrap [name="min"], .vifewc-edit-field-type-info-wrap [name="max"], .vifewc-edit-field-type-info-wrap [name="default"]').removeClass("vifewc-warning-wrap");let t=e('.vifewc-edit-field-type-info-wrap [name="min"]').val()??"",c=e('.vifewc-edit-field-type-info-wrap [name="max"]').val()??"",n=e('.vifewc-edit-field-type-info-wrap [name="default"]').val()??"";return"number"===e(".vifewc-edit-field-type").dropdown("get value")&&(t=t?parseFloat(t):t,c=c?parseFloat(c):c,n=n?parseFloat(n):n),n&&t&&n<t?(e('.vifewc-edit-field-type-info-wrap [name="min"], .vifewc-edit-field-type-info-wrap [name="default"]').addClass("vifewc-warning-wrap"),e(document.body).trigger("villatheme_show_message",["Default Value must be greater or equal than Minimum Value",["error","save-field"],"",!1,4500]),!1):n&&c&&n>c?(e(' .vifewc-edit-field-type-info-wrap [name="max"], .vifewc-edit-field-type-info-wrap [name="default"]').addClass("vifewc-warning-wrap"),e(document.body).trigger("villatheme_show_message",["Default Value must be less or equal than Maximum Value",["error","save-field"],"",!1,4500]),!1):t&&c&&t>c?(e('.vifewc-edit-field-type-info-wrap [name="min"], .vifewc-edit-field-type-info-wrap [name="max"]').addClass("vifewc-warning-wrap"),e(document.body).trigger("villatheme_show_message",["Minimum Value must be less or equal than Maximum Value",["error","save-field"],"",!1,4500]),!1):void 0}),e(document).on("change",'.vifewc-edit-field-type-info-wrap [name="min"], .vifewc-edit-field-type-info-wrap [name="max"], .vifewc-edit-field-type-info-wrap [name="default"]',function(i){e(document.body).trigger("vifewc_popup_checkout_field_validation_min_max")}),e(document).on("change",'.vifewc-edit-field-type-info-wrap [name="step"]',function(i){if(e(this).removeClass("vifewc-warning-wrap"),e(this).val()<1)return e(this).addClass("vifewc-warning-wrap"),e(document.body).trigger("villatheme_show_message",["Step must be greater or equal than 1",["error","save-field"],"",!1,4500]),!1}),e(document).on("change",".vifewc-edit-field-option-checkbox",function(i){if("checkbox_group"===e(".vifewc-edit-field-type").dropdown("get value"))return!1;let t=e(this).closest(".vifewc-edit-field-options-wrap");e(this).addClass("vifewc-edit-field-option-checkbox1"),t.find(".vifewc-edit-field-option-checkbox:not(.vifewc-edit-field-option-checkbox1)").prop("checked",!1),e(this).removeClass("vifewc-edit-field-option-checkbox1")}),e(document).on("click",".vifewc-edit-field-option-clone",function(i){let t=e(this).closest(".vifewc-edit-field-option-wrap");if(!t.find(".vifewc-edit-field-option-value").val()&&e(".vifewc-popup-wrap-field-info .vifewc-edit-field-option-wrap").index(t)>0)return e(document.body).trigger("villatheme_show_message",[vifewc_preview_text.error_option_value_empty,["error","edit-field"],"",!1,4500]),!1;if(!t.find(".vifewc-edit-field-option-label").val())return e(document.body).trigger("villatheme_show_message",[vifewc_preview_text.error_option_label_empty,["error","edit-field"],"",!1,4500]),!1;let c=t.clone();c.find("input").val(""),c.find("input.vifewc-edit-field-option-checkbox").prop("checked",!1),t.after(c)}),e(document).on("click",".vifewc-edit-field-option-remove",function(i){if(1===e(".vifewc-edit-field-option-wrap").length)return e(document.body).trigger("villatheme_show_message",[vifewc_preview_text.error_remove_last_item,["error","edit-field"],"",!1,4500]),!1;confirm(vifewc_preview_text.field_option_remove)&&e(this).closest(".vifewc-edit-field-option-wrap").remove()}),e(document.body).on("vifewc_popup_checkout_field_type_html",function(t,c,n,o,l){if(!c)return!1;let d="";switch(c){case"email":case"tel":case"url":d+='<div class="vifewc-popup-content vifewc-edit-field-type-info-wrap">',d+='<div class="vifewc-popup-content-horizontal vifewc-popup-content-full-row">',d+=`<div class="vifewc-popup-content-title">${vifewc_preview_text.field_title_placeholder}</div>`,d+='<div class="vifewc-popup-content-value">',d+=`<input type="text" name="placeholder" class="vifewc-edit-field-placeholder" value="${l.placeholder||""}">`,d+="</div></div></div>",d+='<div class="vifewc-popup-content vifewc-edit-field-type-info-wrap">',d+='<div class="vifewc-popup-content-horizontal vifewc-popup-content-full-row">',d+=`<div class="vifewc-popup-content-title">${vifewc_preview_text.field_title_default}</div>`,d+='<div class="vifewc-popup-content-value">',d+=`<input type="text" name="default" class="vifewc-edit-field-default" value="${l.default||""}">`,d+="</div></div></div>";break;case"number":d+='<div class="vifewc-popup-content vifewc-edit-field-type-info-wrap">',d+='<div class="vifewc-popup-content-horizontal vifewc-popup-content-full-row">',d+=`<div class="vifewc-popup-content-title">${vifewc_preview_text.field_title_placeholder}</div>`,d+='<div class="vifewc-popup-content-value">',d+=`<input type="text" name="placeholder" class="vifewc-edit-field-placeholder" value="${l.placeholder||""}">`,d+="</div></div></div>",d+='<div class="vifewc-popup-content vifewc-edit-field-type-info-wrap">',d+='<div class="vifewc-popup-content-horizontal vifewc-popup-content-full-row">',d+=`<div class="vifewc-popup-content-title">${vifewc_preview_text.field_title_default}</div>`,d+='<div class="vifewc-popup-content-value">',d+=`<input type="number" name="default" class="vifewc-edit-field-default" value="${l.default||""}">`,d+="</div></div></div>",d+='<div class="vifewc-popup-content vifewc-edit-field-type-info-wrap">',d+='<div class="vifewc-popup-content-horizontal vifewc-popup-content-full-row">',d+=`<div class="vifewc-popup-content-title">${vifewc_preview_text.field_title_step}</div>`,d+='<div class="vifewc-popup-content-value">',d+=`<input type="number" name="step" class="vifewc-edit-field-min" min="1" value="${l.step||""}">`,d+="</div></div></div>",d+='<div class="vifewc-popup-content vifewc-edit-field-type-info-wrap">',d+='<div class="vifewc-popup-content-horizontal vifewc-popup-content-full-row">',d+=`<div class="vifewc-popup-content-title">${vifewc_preview_text.field_title_minvalue}</div>`,d+='<div class="vifewc-popup-content-value">',d+=`<input type="number" name="min" class="vifewc-edit-field-min" value="${l.min||""}">`,d+="</div></div></div>",d+='<div class="vifewc-popup-content vifewc-edit-field-type-info-wrap">',d+='<div class="vifewc-popup-content-horizontal vifewc-popup-content-full-row">',d+=`<div class="vifewc-popup-content-title">${vifewc_preview_text.field_title_maxvalue}</div>`,d+='<div class="vifewc-popup-content-value">',d+=`<input type="number" name="max" class="vifewc-edit-field-max" value="${l.max||""}">`,d+="</div></div></div>";break;case"text":d+='<div class="vifewc-popup-content vifewc-edit-field-type-info-wrap">',d+='<div class="vifewc-popup-content-horizontal vifewc-popup-content-full-row">',d+=`<div class="vifewc-popup-content-title">${vifewc_preview_text.field_title_placeholder}</div>`,d+='<div class="vifewc-popup-content-value">',d+=`<input type="text" name="placeholder" class="vifewc-edit-field-placeholder" value="${l.placeholder||""}">`,d+="</div></div></div>",d+='<div class="vifewc-popup-content vifewc-edit-field-type-info-wrap">',d+='<div class="vifewc-popup-content-horizontal vifewc-popup-content-full-row">',d+=`<div class="vifewc-popup-content-title">${vifewc_preview_text.field_title_default}</div>`,d+='<div class="vifewc-popup-content-value">',d+=`<input type="text" name="default" class="vifewc-edit-field-default" value="${l.default||""}">`,d+="</div></div></div>",d+='<div class="vifewc-popup-content vifewc-edit-field-type-info-wrap">',d+='<div class="vifewc-popup-content-horizontal vifewc-popup-content-full-row">',d+=`<div class="vifewc-popup-content-title">${vifewc_preview_text.field_title_minlength}</div>`,d+='<div class="vifewc-popup-content-value">',d+=`<input type="number" name="minlength" class="vifewc-edit-field-minlength" value="${l.minlength||""}">`,d+="</div></div></div>",d+='<div class="vifewc-popup-content vifewc-edit-field-type-info-wrap">',d+='<div class="vifewc-popup-content-horizontal vifewc-popup-content-full-row">',d+=`<div class="vifewc-popup-content-title">${vifewc_preview_text.field_title_maxlength}</div>`,d+='<div class="vifewc-popup-content-value">',d+=`<input type="number" name="maxlength" class="vifewc-edit-field-maxlength" value="${l.maxlength||""}">`,d+="</div></div></div>";break;case"textarea":d+='<div class="vifewc-popup-content vifewc-edit-field-type-info-wrap">',d+='<div class="vifewc-popup-content-horizontal vifewc-popup-content-full-row">',d+=`<div class="vifewc-popup-content-title">${vifewc_preview_text.field_title_placeholder}</div>`,d+='<div class="vifewc-popup-content-value">',d+=`<textarea name="placeholder" class="vifewc-edit-field-placeholder" cols="30" rows="5">${l.placeholder||""}</textarea>`,d+="</div></div></div>",d+='<div class="vifewc-popup-content vifewc-edit-field-type-info-wrap">',d+='<div class="vifewc-popup-content-horizontal vifewc-popup-content-full-row">',d+=`<div class="vifewc-popup-content-title">${vifewc_preview_text.field_title_default}</div>`,d+='<div class="vifewc-popup-content-value">',d+=`<textarea name="default" class="vifewc-edit-field-default" cols="30" rows="5">${l.default||""}</textarea>`,d+="</div></div></div>",d+='<div class="vifewc-popup-content vifewc-edit-field-type-info-wrap">',d+='<div class="vifewc-popup-content-horizontal vifewc-popup-content-full-row">',d+=`<div class="vifewc-popup-content-title">${vifewc_preview_text.field_title_minlength}</div>`,d+='<div class="vifewc-popup-content-value">',d+=`<input type="number" name="minlength" class="vifewc-edit-field-minlength" value="${l.minlength||""}">`,d+="</div></div></div>",d+='<div class="vifewc-popup-content vifewc-edit-field-type-info-wrap">',d+='<div class="vifewc-popup-content-horizontal vifewc-popup-content-full-row">',d+=`<div class="vifewc-popup-content-title">${vifewc_preview_text.field_title_maxlength}</div>`,d+='<div class="vifewc-popup-content-value">',d+=`<input type="number" name="maxlength" class="vifewc-edit-field-maxlength" value="${l.maxlength||""}">`,d+="</div></div></div>";break;case"checkbox":d+='<div class="vifewc-popup-content vifewc-edit-field-type-info-wrap">',d+='<div class="vifewc-popup-content-horizontal vifewc-popup-content-full-row">',d+=`<div class="vifewc-popup-content-title">${vifewc_preview_text.field_title_checked_default}</div>`,d+='<div class="vifewc-popup-content-value">',d+='<div class="vi-ui toggle checkbox">',d+=`<input type="hidden" name="default" class="vifewc-edit-field-default" value="${l.default||""}">`,d+=`<input type="checkbox" class="vifewc-edit-field-default-checkbox vifewc-customize-checkbox" ${l.default?"checked":""}><label></label></div>`,d+="</div></div></div>";break;case"checkbox_group":case"select":case"radio":if("select"!==c){let i=l.checkboxgroup_style||"vertical";d+='<div class="vifewc-popup-content vifewc-edit-field-type-info-wrap">',d+='<div class="vifewc-popup-content-horizontal vifewc-popup-content-full-row">',d+=`<div class="vifewc-popup-content-title">${vifewc_preview_text.field_title_checkboxgroup_style}</div>`,d+='<div class="vifewc-popup-content-value">',d+='<select class="vifewc-edit-field-checkboxgroup_style vi-ui fluid dropdown" name=checkboxgroup_style>',e.each(vifewc_preview_setting.checkboxgroup_style,function(e,t){d+=`<option value="${e}" ${i===e?" selected ":""}>${t}</option>`}),d+="</select>",d+="</div></div></div>"}d+='<div class="vifewc-popup-content vifewc-edit-field-type-info-wrap">',d+='<div class="vifewc-popup-content-vertical vifewc-popup-content-full-row">',d+=`<div class="vifewc-popup-content-title">${vifewc_preview_text.field_title_options}</div>`,d+='<div class="vifewc-popup-content-value vifewc-popup-content-field-options">',d+='<div class="vifewc-edit-field-options-wrap">';let i=l.vifewc_options_id||{},t=l.vifewc_options||{},n="checkbox_group"===c?vifewc_preview_text.field_title_checked_default:vifewc_preview_text.field_title_selected_default;if(Object.keys(t).length){let o=!1;e.each(i,function(e,i){let l=i,s=t[i],a=s.is_selected?"checked":"";"checkbox_group"!==c&o&&a&&(a=""),a&&(o=!0),d+='<div class="vifewc-edit-field-option-wrap">',d+='<span class="vifewc-edit-field-option-action vifewc-edit-field-option-move"><i class="expand arrows alternate icon"></i></span>',d+='<div class="vifewc-edit-field-option-container">',d+='<div class="vifewc-edit-field-option-value-wrap">',d+=`<input type="text" class="vifewc-edit-field-option-value" value="${l}" placeholder="${vifewc_preview_text.field_title_option_value}">`,d+="</div>",d+='<div class="vifewc-edit-field-option-label-wrap">',d+=`<input type="text" class="vifewc-edit-field-option-label" value="${s.label||""}" placeholder="${vifewc_preview_text.field_title_option_label}">`,d+="</div>",d+='<div class="vifewc-edit-field-option-checkbox-wrap">',d+=`<input type="checkbox" class="vifewc-edit-field-option-checkbox" ${a?"checked":""} title='${n}'>`,d+="</div>",d+="</div>",d+=`<span class="vifewc-edit-field-option-action vifewc-edit-field-option-clone" title="${vifewc_preview_text.clone}"><i class="clone icon"></i></span>`,d+=`<span class="vifewc-edit-field-option-action vifewc-edit-field-option-remove" title="${vifewc_preview_text.remove}"><i class="times icon"></i></span>`,d+="</div>"})}else d+='<div class="vifewc-edit-field-option-wrap">',d+='<span class="vifewc-edit-field-option-action vifewc-edit-field-option-move"><i class="expand arrows alternate icon"></i></span>',d+='<div class="vifewc-edit-field-option-container">',d+='<div class="vifewc-edit-field-option-value-wrap">',d+=`<input type="text" class="vifewc-edit-field-option-value" value="" placeholder="${vifewc_preview_text.field_title_option_value}">`,d+="</div>",d+='<div class="vifewc-edit-field-option-label-wrap">',d+=`<input type="text" class="vifewc-edit-field-option-label" placeholder="${vifewc_preview_text.field_title_option_label}">`,d+="</div>",d+='<div class="vifewc-edit-field-option-checkbox-wrap">',d+=`<input type="checkbox" class="vifewc-edit-field-option-checkbox" title='${n}'>`,d+="</div>",d+="</div>",d+=`<span class="vifewc-edit-field-option-action vifewc-edit-field-option-clone" title="${vifewc_preview_text.clone}"><i class="clone icon"></i></span>`,d+=`<span class="vifewc-edit-field-option-action vifewc-edit-field-option-remove" title="${vifewc_preview_text.remove}"><i class="times icon"></i></span>`,d+="</div>";d+="</div>",d+="</div></div></div>";break;case"datetime-local":case"time":case"date":case"week":case"month":d+='<div class="vifewc-popup-content vifewc-edit-field-type-info-wrap">',d+='<div class="vifewc-popup-content-horizontal vifewc-popup-content-full-row">',d+=`<div class="vifewc-popup-content-title">${vifewc_preview_text.field_title_default}</div>`,d+='<div class="vifewc-popup-content-value">',d+=`<input type="${c}" name="default" class="vifewc-edit-field-default" value="${l.default||""}">`,d+="</div></div></div>",d+='<div class="vifewc-popup-content vifewc-edit-field-type-info-wrap">',d+='<div class="vifewc-popup-content-horizontal vifewc-popup-content-full-row">',d+=`<div class="vifewc-popup-content-title">${vifewc_preview_text.field_title_minvalue}</div>`,d+='<div class="vifewc-popup-content-value">',d+=`<input type="${c}" name="min" class="vifewc-edit-field-min" value="${l.min||""}">`,d+="</div></div></div>",d+='<div class="vifewc-popup-content vifewc-edit-field-type-info-wrap">',d+='<div class="vifewc-popup-content-horizontal vifewc-popup-content-full-row">',d+=`<div class="vifewc-popup-content-title">${vifewc_preview_text.field_title_maxvalue}</div>`,d+='<div class="vifewc-popup-content-value">',d+=`<input type="${c}" name="max" class="vifewc-edit-field-max" value="${l.max||""}">`,d+="</div></div></div>";break;case"hidden":d+='<div class="vifewc-popup-content vifewc-edit-field-type-info-wrap">',d+='<div class="vifewc-popup-content-horizontal vifewc-popup-content-full-row">',d+=`<div class="vifewc-popup-content-title">${vifewc_preview_text.field_title_default}</div>`,d+='<div class="vifewc-popup-content-value">',d+=`<input type="text" name="default" class="vifewc-edit-field-default" value="${l.default||""}">`,d+="</div></div></div>";break;case"password":d+='<div class="vifewc-popup-content vifewc-edit-field-type-info-wrap">',d+='<div class="vifewc-popup-content-horizontal vifewc-popup-content-full-row">',d+=`<div class="vifewc-popup-content-title">${vifewc_preview_text.field_title_placeholder}</div>`,d+='<div class="vifewc-popup-content-value">',d+=`<input type="text" name="placeholder" class="vifewc-edit-field-placeholder" value="${l.placeholder||""}">`,d+="</div></div></div>",d+='<div class="vifewc-popup-content vifewc-edit-field-type-info-wrap">',d+='<div class="vifewc-popup-content-horizontal vifewc-popup-content-full-row">',d+=`<div class="vifewc-popup-content-title">${vifewc_preview_text.field_title_minlength}</div>`,d+='<div class="vifewc-popup-content-value">',d+=`<input type="number" name="minlength" class="vifewc-edit-field-minlength" value="${l.minlength||""}">`,d+="</div></div></div>",d+='<div class="vifewc-popup-content vifewc-edit-field-type-info-wrap">',d+='<div class="vifewc-popup-content-horizontal vifewc-popup-content-full-row">',d+=`<div class="vifewc-popup-content-title">${vifewc_preview_text.field_title_maxlength}</div>`,d+='<div class="vifewc-popup-content-value">',d+=`<input type="number" name="maxlength" class="vifewc-edit-field-maxlength" value="${l.maxlength||""}">`,d+="</div></div></div>";break;case"html":d+='<div class="vifewc-popup-content vifewc-edit-field-type-info-wrap">',d+='<div class="vifewc-popup-content-horizontal vifewc-popup-content-full-row">',d+=`<div class="vifewc-popup-content-title">${vifewc_preview_text.field_title_content}</div>`,d+='<div class="vifewc-popup-content-value">',d+=`<textarea name="default" class="vifewc-edit-field-default" cols="30" rows="10">${l.default||""}</textarea>`,d+="</div></div></div>"}["html","hidden"].includes(c)||(d+='<div class="vifewc-popup-content vifewc-edit-field-type-info-wrap">',d+='<div class="vifewc-popup-content-horizontal vifewc-popup-content-full-row">',d+=`<div class="vifewc-popup-content-title">${vifewc_preview_text.field_title_desc}</div>`,d+='<div class="vifewc-popup-content-value">',d+=`<input type="text" name="description" class="vifewc-edit-field-description" value="${l.description||""}">`,d+="</div></div></div>"),e(".vifewc-edit-field-type-info-wrap").addClass("vifewc-edit-field-type-info-wrap-old"),d&&(d=e(d),d.find(".vi-ui.dropdown").dropdown(),d.find(".vifewc-edit-field-options-wrap").sortable({connectWith:".vifewc-edit-field-option-wrap",handle:".vifewc-edit-field-option-move",placeholder:"vifewc-placeholder",axis:"y"}),setTimeout(function(t){e(".vifewc-edit-field-type-wrap-wrap").after(t),i()},100,d)),e(".vifewc-edit-field-type-info-wrap-old").animate({height:"0px"},400,"swing",function(){e(".vifewc-edit-field-type-info-wrap-old").remove()})}),e(document.body).on("vifewc_popup_checkout_field_html",function(){let t=e(".vifewc-customize-fields").data("section_id");if(!t)return!1;let c=vifewc_preview_setting.section_fields_default[t]||{},n=e(".vifewc-customize-field-editing").data("id")||t+"_"+Date.now(),o=e(".vifewc-customize-field-editing").data("data")||{};wp.customize.previewer.send("vifewc_editing_field",n);let l=o.type??"text",d=o.enable??1,s=o.required??"",a=o.html_type??"",v=void 0===c[n]?1:"",f=o.display_in??(["html","hidden","password"].includes(l)?[]:Object.keys(vifewc_preview_setting.fields_display_in)),p=o.save_as??["order_meta"],w=o.class??["form-row-wide"],u=o.label_class??[],r=o.input_class??[],_=["html","hidden"];s=s?1:"",w=w.join(","),u=u.join(","),r=r.join(",");let m='<div class="vifewc-popup-wrap vifewc-popup-wrap-field-info">';m+='<div class="vifewc-popup"><div class="vifewc-overlay vifewc-overlay-loading"></div><div class="vifewc-overlay"></div>',m+='<div class="vifewc-popup-container-wrap"><span class="vifewc-popup-close">&#43;</span>',m+='<div class="vifewc-popup-container">',m+=`<div class="vifewc-popup-header-wrap">${vifewc_preview_text.field_info_title}</div>`,m+='<div class="vifewc-popup-content-wrap">',m+='<div class="vi-ui fluid accordion">',m+=`<div class="title active"><i class="dropdown icon"></i>${vifewc_preview_text.field_general_title}</div>`,m+='<div class="content active"><div class="vifewc-popup-content-container">',m+='<div class="vifewc-popup-content">',m+='<div class="vifewc-popup-content-horizontal vifewc-popup-content-full-row">',m+=`<div class="vifewc-popup-content-title">${vifewc_preview_text.field_title_enable}</div>`,m+='<div class="vifewc-popup-content-value">',m+='<div class="vi-ui toggle checkbox">',m+=`<input type="hidden" name="enable" class="vifewc-edit-field-enable" value="${d}">`,m+=`<input type="checkbox" class="vifewc-edit-field-enable-checkbox vifewc-customize-checkbox" ${d?"checked":""}><label></label></div>`,m+="</div></div></div>",m+=`<div class="vifewc-popup-content vifewc-edit-field-required-wrap${_.includes(l)?" vifewc-hidden":""}">`,m+='<div class="vifewc-popup-content-horizontal vifewc-popup-content-full-row">',m+=`<div class="vifewc-popup-content-title">${vifewc_preview_text.field_title_required}</div>`,m+='<div class="vifewc-popup-content-value">',m+='<div class="vi-ui toggle checkbox">',m+=`<input type="hidden" name="required" class="vifewc-edit-field-required" value="${s}">`,m+=`<input type="checkbox" class="vifewc-edit-field-required-checkbox vifewc-customize-checkbox" ${s?"checked":""}><label></label></div>`,m+="</div></div></div>",m+='<div class="vifewc-popup-content vifewc-edit-field-label-wrap">',m+='<div class="vifewc-popup-content-horizontal vifewc-popup-content-full-row">',m+=`<div class="vifewc-popup-content-title">${vifewc_preview_text.field_title_label}</div>`,m+='<div class="vifewc-popup-content-value">',m+=`<input type="hidden" class="vifewc-edit-field-section-id" value="${t}">`,m+=`<input type="hidden" class="vifewc-edit-field-id" value="${n}">`,m+=`<input type="hidden" name="is_custom" class="vifewc-edit-field-is_custom" value="${v}">`,m+=`<input type="text" name="label" class="vifewc-edit-field-label" value="${o.label||""}">`,m+="</div></div></div>",v?(m+='<div class="vifewc-popup-content vifewc-edit-field-type-wrap-wrap">',m+='<div class="vifewc-popup-content-horizontal vifewc-popup-content-full-row">',m+=`<div class="vifewc-popup-content-title">${vifewc_preview_text.field_title_type}</div>`,m+='<div class="vifewc-popup-content-value">',m+='<div class="vifewc-edit-field-type-wrap">',m+='<select class="vifewc-edit-field-type vi-ui fluid dropdown" name="type">',e.each(vifewc_preview_setting.fields_type,function(e,i){m+=`<option value="${e}" ${l===e||void 0!==vifewc_preview_setting.fields_time_type[l]&&"datetime"===e?" selected ":""}>${i}</option>`}),m+="</select>",m+="</div>",m+=`<div class="vifewc-edit-field-html-type-wrap${"html"!==l?" vifewc-hidden":""}">`,m+='<select class="vifewc-edit-field-html-type vi-ui fluid dropdown" name="html_type">',e.each(vifewc_preview_setting.fields_html_type,function(i,t){m+=`<optgroup label="${t.name||""}">`,e.each(t.type||{},function(e,i){m+=`<option value="${e}" ${a===e?" selected ":""}>${i}</option>`}),m+="</optgroup>"}),m+="</select>",m+="</div>",m+=`<div class="vifewc-edit-field-time-type-wrap${void 0===vifewc_preview_setting.fields_time_type[l]?" vifewc-hidden":""}">`,m+='<select class="vifewc-edit-field-time-type vi-ui fluid dropdown" name="time_type">',e.each(vifewc_preview_setting.fields_time_type,function(e,i){m+=`<option value="${e}" ${l===e?" selected ":""}>${i}</option>`}),m+="</select>",m+="</div>",m+="</div></div></div>",e(document.body).trigger("vifewc_popup_checkout_field_type_html",[l,a,n,o]),m+=`<div class="vifewc-popup-content vifewc-edit-field-validate-wrap${["email","tel","number","text","url"].includes(l)?"":" vifewc-hidden"}">`,m+='<div class="vifewc-popup-content-horizontal vifewc-popup-content-full-row">',m+=`<div class="vifewc-popup-content-title">${vifewc_preview_text.field_title_validation}</div>`,m+='<div class="vifewc-popup-content-value">',m+='<select class="vifewc-edit-field-validate vi-ui fluid dropdown" name="validate">',e.each(vifewc_preview_setting.field_validate,function(e,i){m+=`<option value="${e}" >${i}</option>`}),m+="</select>",m+="</div></div></div>"):["country","state"].includes(l)||(m+='<div class="vifewc-popup-content vifewc-edit-field-type-info-wrap">',m+='<div class="vifewc-popup-content-horizontal vifewc-popup-content-full-row">',m+=`<div class="vifewc-popup-content-title">${vifewc_preview_text.field_title_placeholder}</div>`,m+='<div class="vifewc-popup-content-value">',m+=`<input type="text" name="placeholder" class="vifewc-edit-field-placeholder" value="${o.placeholder||""}">`,m+="</div></div></div>"),m+="</div></div>",m+=`<div class="title"><i class="dropdown icon"></i>${vifewc_preview_text.field_design_title}</div>`,m+='<div class="content"><div class="vifewc-popup-content-container">',m+='<div class="vifewc-popup-content vifewc-popup-content-desc">',m+=`<div class="vifewc-popup-content-horizontal vifewc-popup-content-full-row" title='${vifewc_preview_text.wrap_class_desc}'>`,m+=`<div class="vifewc-popup-content-title">${vifewc_preview_text.field_title_class}<span class="vifewc-popup-content-tooltip"><i class="icon question circle outline"></i></span></div>`,m+='<div class="vifewc-popup-content-value">',m+=`<input type="text" name="class" class="vifewc-edit-field-class" value="${w}">`,m+="</div></div></div>",m+=`<div class="vifewc-popup-content vifewc-edit-field-label_class-wrap${"html"===l?" vifewc-hidden":""}">`,m+='<div class="vifewc-popup-content-horizontal vifewc-popup-content-full-row">',m+=`<div class="vifewc-popup-content-title">${vifewc_preview_text.field_title_label_class}</div>`,m+='<div class="vifewc-popup-content-value">',m+=`<input type="text" name="label_class" class="vifewc-edit-field-label_class" value="${u}">`,m+="</div></div></div>",m+=`<div class="vifewc-popup-content vifewc-edit-field-input_class-wrap${"html"===l?" vifewc-hidden":""}">`,m+='<div class="vifewc-popup-content-horizontal vifewc-popup-content-full-row">',m+=`<div class="vifewc-popup-content-title">${vifewc_preview_text.field_title_input_class}</div>`,m+='<div class="vifewc-popup-content-value">',m+=`<input type="text" name="input_class" class="vifewc-edit-field-input_class" value="${r}">`,m+="</div></div></div>",m+="</div></div>",v&&(m+=`<div class="title"><i class="dropdown icon"></i>${vifewc_preview_text.field_data_title}</div>`,m+='<div class="content"><div class="vifewc-popup-content-container">',m+=`<div class="vifewc-popup-content vifewc-edit-field-save_as-wrap${_.includes(l)?" vifewc-hidden":""}">`,m+='<div class="vifewc-popup-content-horizontal vifewc-popup-content-full-row">',m+=`<div class="vifewc-popup-content-title">${vifewc_preview_text.field_title_save_as}</div>`,m+='<div class="vifewc-popup-content-value">',m+='<select class="vifewc-edit-field-save_as vi-ui fluid dropdown" multiple name=save_as>',e.each(vifewc_preview_setting.field_as_meta,function(e,i){m+=`<option value="${e}" >${i}</option>`}),m+="</select>",m+="</div></div></div>",m+=`<div class="vifewc-popup-content vifewc-edit-field-save_as-wrap vifewc-edit-field-meta_key-wrap${_.includes(l)||!p.length?" vifewc-hidden":""}">`,m+='<div class="vifewc-popup-content-horizontal vifewc-popup-content-full-row">',m+=`<div class="vifewc-popup-content-title">${vifewc_preview_text.field_title_meta_key}<span class="vifewc-popup-content-tooltip" title='${vifewc_preview_text.meta_key_desc}'><i class="icon question circle outline"></i></span></div>`,m+='<div class="vifewc-popup-content-value">',m+=`<input type="text" name="meta_key" class="vifewc-edit-field-meta_key" value="${o.meta_key??t+"_"}">`,m+="</div></div></div>",m+=`<div class="vifewc-popup-content vifewc-edit-field-display_in-wrap${_.includes(l)||!p.length?" vifewc-hidden":""}">`,m+='<div class="vifewc-popup-content-horizontal vifewc-popup-content-full-row">',m+=`<div class="vifewc-popup-content-title">${vifewc_preview_text.field_title_display}</div>`,m+='<div class="vifewc-popup-content-value">',m+='<select class="vifewc-edit-field-display_in vi-ui fluid dropdown" multiple name="display_in">',e.each(vifewc_preview_setting.fields_display_in,function(e,i){m+=`<option value="${e}" >${i}</option>`}),m+="</select>",m+="</div></div></div>",m+="</div></div>"),m+="</div></div>",m+='<div class="vifewc-popup-footer-wrap">',m+=`<span class="vifewc-button vifewc-popup-bt vifewc-popup-wrap-field-info-bt-save">${vifewc_preview_text.save}</span>`,m+="</div>",m+="</div></div></div></div>",m=e(m),m.find(".vi-ui.accordion").villatheme_accordion("refresh"),m.find(".vi-ui.dropdown").dropdown(),setTimeout(function(t){i(),e(t).find(".vi-ui.dropdown.selection").has("optgroup").each(function(){let i=e("<div/>").addClass("menu");return e(this).find("optgroup").each(function(){return i.append('<div class="vifewc-dropdown-header">'+this.label+"</div></div>"),e(this).children().each(function(){return i.append('<div class="item" data-value="'+this.value+'">'+this.innerHTML+"</div>")})}),e(this).find(".menu").html(i.html())}),e(t).find(".vifewc-edit-field-save_as").dropdown("set selected",p),e(t).find(".vifewc-edit-field-display_in").dropdown("set selected",f),e(t).find(".vifewc-edit-field-validate").dropdown("set selected",o.validate&&o.validate[0]||"")},100,m),m.find(".vifewc-edit-field-type").dropdown({onChange:function(i){let t;["email","tel","number","text","url"].includes(i)?(m.find(".vifewc-edit-field-validate-wrap").removeClass("vifewc-hidden"),e(".vifewc-edit-field-default").val(null),e(".vi-ui.dropdown.vifewc-edit-field-validate").dropdown("set exactly","tel"===i?"phone":i)):(m.find(".vifewc-edit-field-validate-wrap").addClass("vifewc-hidden"),e(".vi-ui.dropdown.vifewc-edit-field-validate").dropdown("set exactly","")),_.includes(i)?("html"===i?m.find(".vifewc-edit-field-html-type-wrap").removeClass("vifewc-hidden"):m.find(".vifewc-edit-field-html-type-wrap").addClass("vifewc-hidden"),m.find(".vifewc-edit-field-time-type-wrap").addClass("vifewc-hidden"),m.find(".vifewc-edit-field-input_class-wrap").addClass("vifewc-hidden"),m.find(".vifewc-edit-field-label_class-wrap").addClass("vifewc-hidden"),m.find(".vifewc-edit-field-required-wrap").addClass("vifewc-hidden"),m.find(".vifewc-edit-field-save_as-wrap").addClass("vifewc-hidden"),m.find(".vifewc-edit-field-meta_key-wrap").addClass("vifewc-hidden"),m.find(".vifewc-edit-field-display_in-wrap").addClass("vifewc-hidden")):(m.find(".vifewc-edit-field-html-type-wrap").addClass("vifewc-hidden"),"datetime"===i?(i=m.find(".vifewc-edit-field-time-type").dropdown("get value")||"datetime-local",m.find(".vifewc-edit-field-time-type-wrap").removeClass("vifewc-hidden")):m.find(".vifewc-edit-field-time-type-wrap").addClass("vifewc-hidden"),m.find(".vifewc-edit-field-required-wrap").removeClass("vifewc-hidden"),m.find(".vifewc-edit-field-save_as-wrap").removeClass("vifewc-hidden"),m.find(".vifewc-edit-field-input_class-wrap").removeClass("vifewc-hidden"),m.find(".vifewc-edit-field-label_class-wrap").removeClass("vifewc-hidden"),m.find(".vifewc-edit-field-save_as").dropdown("get value").length?(m.find(".vifewc-edit-field-meta_key-wrap").removeClass("vifewc-hidden"),m.find(".vifewc-edit-field-display_in-wrap").removeClass("vifewc-hidden")):(m.find(".vifewc-edit-field-meta_key-wrap").addClass("vifewc-hidden"),m.find(".vifewc-edit-field-display_in-wrap").addClass("vifewc-hidden"))),t=["html","hidden","password"].includes(i)?[]:o.display_in??Object.keys(vifewc_preview_setting.fields_display_in),m.find(".vifewc-edit-field-display_in").off().dropdown("set exactly",t),e(document.body).trigger("vifewc_popup_checkout_field_type_html",[i,"html"===i?m.find(".vifewc-edit-field-html-type").dropdown("get value"):"",n,o])}}),m.find(".vifewc-edit-field-html-type").dropdown({onChange:function(i){e(document.body).trigger("vifewc_popup_checkout_field_type_html",["html",i,n,o])}}),m.find(".vifewc-edit-field-time-type").dropdown({onChange:function(i){e(document.body).trigger("vifewc_popup_checkout_field_type_html",[i,"",n,o])}}),m.find(".vifewc-edit-field-save_as-wrap:not(.vifewc-hidden) .vifewc-edit-field-save_as").dropdown({onChange:function(e){e&&e.length?(m.find(".vifewc-edit-field-meta_key-wrap").removeClass("vifewc-hidden"),m.find(".vifewc-edit-field-display_in-wrap").removeClass("vifewc-hidden")):(m.find(".vifewc-edit-field-meta_key-wrap").addClass("vifewc-hidden"),m.find(".vifewc-edit-field-display_in-wrap").addClass("vifewc-hidden"))}}),e("body").append(m),setTimeout(function(){e(".vifewc-popup-wrap-field-info").removeClass("vifewc-popup-wrap-hidden").addClass("vifewc-popup-wrap-show")},100)}),e(document).on("click",".vifewc-customize-field-enable, .vifewc-customize-field-disable",function(i){e(this).closest(".vifewc-customize-field-wrap").addClass("vifewc-customize-field-editing");let t=e(this).closest(".vifewc-customize-fields").data("section_id"),c=e(this).closest(".vifewc-customize-field-wrap").data("id"),n=JSON.parse(wp.customize("vifewc_sections_params[section_fields]").get());if(!t||!c)return e(document.body).trigger("villatheme_show_message",["Can not change field data",["error","save-field"],"",!1,4500]),!1;let o=n[t][c]||{};e(this).hasClass("vifewc-customize-field-enable")?(o.enable="",e(".vifewc-customize-field-editing").removeClass("vifewc-customize-field-wrap-enable"),e(".vifewc-customize-field-editing").find(".vifewc-customize-field-disable").removeClass("vifewc-hidden"),e(".vifewc-customize-field-editing").find(".vifewc-customize-field-enable").addClass("vifewc-hidden")):(o.enable=1,e(".vifewc-customize-field-editing").addClass("vifewc-customize-field-wrap-enable"),e(".vifewc-customize-field-editing").find(".vifewc-customize-field-disable").addClass("vifewc-hidden"),e(".vifewc-customize-field-editing").find(".vifewc-customize-field-enable").removeClass("vifewc-hidden")),n[t][c]=o,e(".vifewc-customize-field-editing").removeClass("vifewc-customize-field-editing"),wp.customize("vifewc_sections_params[section_fields]").set(JSON.stringify(n))}),e(document).on("click",".vifewc-customize-field-clone",function(i){let t=JSON.parse(wp.customize("vifewc_sections_params[section_fields]").get()),c=e(".vifewc-customize-fields"),n=e(this).closest(".vifewc-customize-field-wrap"),o=c.data("section_id"),l=n.data("id"),d=n.clone(),s=Date.now(),a=t[o]||{},v=o+"_"+Date.now(),f={...a[l]||{}},p=f.label||f.meta_key.replace(o+"_","")||l;f.label="Copy of "+p,d.find(".vifewc-customize-field-title").html(f.label),f.meta_key=o+"_"+f.type+"_"+s,d.data({id:v,data:f}),n.after(d),setTimeout(function(){e(document.body).trigger("vifewc_checkout_fields_sortable")},100)}),e(document).on("click",".vifewc-customize-field-remove",function(i){if(!confirm(vifewc_preview_text.field_remove))return!1;let t=JSON.parse(wp.customize("vifewc_sections_params[section_fields]").get()),c=e(".vifewc-customize-fields"),n=e(this).closest(".vifewc-customize-field-wrap"),o=c.data("section_id"),l=n.data("id"),d=t[o]||{},s=vifewc_preview_setting.section_fields_default[o]||{};if(!o||!l||void 0!==s[l]||void 0===d[l])return e(document.body).trigger("villatheme_show_message",[vifewc_preview_text.error_remove_field,["error","edit-field"],"",!1,4500]),!1;n.remove(),setTimeout(function(){e(document.body).trigger("vifewc_checkout_fields_sortable")},100)}),e(document).on("click",".vifewc-customize-field-edit, .vifewc-fields-add_new",function(i){e(this).closest(".vifewc-customize-field-wrap").addClass("vifewc-customize-field-editing"),e(".vifewc-popup-wrap-field-info").length||e(document.body).trigger("vifewc_popup_checkout_field_html")}),e(document).on("click",".vifewc-fields-reset",function(i){let t=JSON.parse(wp.customize("vifewc_sections_params[section_fields]").get()),c=e(".vifewc-customize-fields").data("section_id");if(!c||!vifewc_preview_setting.section_fields_default[c]||!confirm("Changes you made may be overridden by default."))return!1;t[c]=vifewc_preview_setting.section_fields_default[c],wp.customize("vifewc_sections_params[section_fields]").set(JSON.stringify(t)),setTimeout(function(i){e(document.body).trigger("vifewc_checkout_fields_html",[i])},100,c)}),e(document.body).on("vifewc_checkout_fields_sortable",function(){let i=JSON.parse(wp.customize("vifewc_sections_params[section_fields]").get()),t=e(".vifewc-customize-fields"),c=t.data("section_id");if(!c)return!1;let n={},o=1;t.find(".vifewc-customize-field-wrap").each(function(i,t){let c=e(t).data("data"),l=e(t).data("id");if(!l||!c||!Object.keys(c).length)return!1;c.priority=10*o,n[l]=c,e(t).data("data",c),o++}),i[c]=n,wp.customize("vifewc_sections_params[section_fields]").set(JSON.stringify(i))}),e(document.body).on("vifewc_checkout_fields_html",function(i,t=""){if(!t)return wp.customize.section("vifewc").expanded(!0),!1;let c=JSON.parse(wp.customize("vifewc_sections_params[section_settings]").get()),n=JSON.parse(wp.customize("vifewc_sections_params[section_fields]").get())[t]||{},o=vifewc_preview_setting.section_fields_default[t]||{},l=e("#sub-accordion-section-vifewc-customize-fields .customize-section-title h3");l.data("vifewc_title")?l.html(l.data("vifewc_title").replace("{checkout_fields}",c[t].name||t)):(l.data("vifewc_title",l.html()),l.html(l.html().replace("{checkout_fields}",c[t].name||t))),e(".vifewc-customize-fields").data("section_id",t).html(""),e(".vifewc-customize-fields-action .vifewc-fields-reset").remove(),Object.keys(o).length&&e(".vifewc-customize-fields-action").append(`<span class="vifewc-button vifewc-fields-reset"><i class="icon redo"></i>${vifewc_preview_text.section_fields_reset}</span>`),e.each(n,function(i,c){let n="",l=c.enable??1;n+=`<div class="vifewc-customize-field-wrap${l?" vifewc-customize-field-wrap-enable":""}">`,n+='<div class="vifewc-customize-field">',n+=`<div class="vifewc-customize-field-title">${c.label||c.meta_key.replace(t+"_","")||i}<span>${c.required?'&nbsp;<abbr class="required">*</abbr>':""}</span></div>`,n+='<div class="vifewc-customize-field-action">',n+=`<span class="vifewc-customize-field-edit" title="${vifewc_preview_text.edit}"><i class="vi-ui icon edit outline"></i></span>`,!c.is_custom&&o[i]||(n+=`<span class="vifewc-customize-field-clone" title="${vifewc_preview_text.clone}"><i class="vi-ui icon clone outline"></i></span>`,n+=`<span class="vifewc-customize-field-remove" title="${vifewc_preview_text.remove}"><i class="vi-ui icon trash alternate outline"></i></span>`),n+=`<span class="vifewc-customize-field-enable${l?"":" vifewc-hidden"}" title="${vifewc_preview_text.disable}"><i class="dashicons dashicons-visibility"></i></span>`,n+=`<span class="vifewc-customize-field-disable${l?" vifewc-hidden":""}" title="${vifewc_preview_text.enable}"><i class="dashicons dashicons-hidden"></i></span>`,n+="</div></div></div>",n=e(n),n.data({id:i,data:c}),e(".vifewc-customize-fields").append(n)}),e(".vifewc-customize-fields").sortable({connectWith:".vifewc-customize-field-wrap",handle:".vifewc-customize-field",cancel:".vifewc-customize-field-action",placeholder:"vifewc-placeholder",axis:"y",stop:function(i,t){e(document.body).trigger("vifewc_checkout_fields_sortable")}})}),e(document).on("click",".vifewc-section",function(){e(this).closest(".vifewc-section").addClass("vifewc-section-editing"),wp.customize.section("vifewc-customize-fields").expanded(!0)}),e(document).on("click",".vifewc-section-edit-fields",function(){e(".vifewc-section-editing").length&&wp.customize.section("vifewc-customize-fields").expanded(!0)}),e(document).on("click",".vifewc-section-remove",function(i){if(i.preventDefault(),i.stopPropagation(),!confirm(vifewc_preview_text.section_remove))return!1;let t,c=JSON.parse(wp.customize("vifewc_sections_params[section_id]").get()),n=JSON.parse(wp.customize("vifewc_sections_params[section_settings]").get());e(this).closest(".vifewc-section").length?(t=e(this).closest(".vifewc-section").data("section_id"),c.splice(c.indexOf(t.toString()),1),delete n[t],wp.customize("vifewc_sections_params[section_id]").set(JSON.stringify(c)),wp.customize("vifewc_sections_params[section_settings]").set(JSON.stringify(n)),e(this).closest(".vifewc-section").remove()):(t=e(this).closest(".vifewc-customize-section-wrap").find(".vifewc-customize-section-content-id-value").val(),c.splice(c.indexOf(t.toString()),1),delete n[t],wp.customize("vifewc_sections_params[section_id]").set(JSON.stringify(c)),wp.customize("vifewc_sections_params[section_settings]").set(JSON.stringify(n)),setTimeout(function(){wp.customize.section("vifewc").expanded(!0)},100))}),e(document).on("click",".vifewc-section-add_new",function(){wp.customize.section("vifewc-customize-section").expanded(!0)}),e(document).on("click",".vifewc-section-edit",function(i){i.preventDefault(),i.stopPropagation(),e(this).closest(".vifewc-section").addClass("vifewc-section-editing"),wp.customize.section("vifewc-customize-section").expanded(!0)}),e(document).on("click",".vifewc-section-save",function(){let i=JSON.parse(wp.customize("vifewc_sections_params[section_id]").get()),t=JSON.parse(wp.customize("vifewc_sections_params[section_settings]").get()),c=e(this).closest(".vifewc-customize-section-wrap"),n="",o=c.find(".vifewc-customize-section-content-name-value").val(),l=c.find(".vifewc-customize-section-content-id-value").val();if(!o)return e(document.body).trigger("villatheme_show_message",[vifewc_preview_text.error_name_empty,["error","save-section"],"",!1,4500]),!1;i.includes(l)?n=t[l]?.name:i.push(l);let d=e.map(t,function(e){return e.name||""});if(n!=o&&d.includes(o))return e(document.body).trigger("villatheme_show_message",[vifewc_preview_text.error_name_unique,["error","save-section"],"",!1,4500]),!1;t[l]={name:o,title:c.find(".vifewc-customize-section-content-title-value").val(),title_color:c.find(".vifewc-customize-section-content-name_color-value").val(),position:c.find(".vifewc-customize-section-content-position-value").val()},wp.customize("vifewc_sections_params[section_id]").set(JSON.stringify(i)),wp.customize("vifewc_sections_params[section_settings]").set(JSON.stringify(t)),setTimeout(function(i){(i=e(i)).find(".vifewc-customize-section-add_new").length&&wp.customize.section("vifewc-customize-fields").expanded(!0)},100,c)}),e(document.body).on("vifewc_only_checkout_sections_html",function(){let i=JSON.parse(wp.customize("vifewc_sections_params[section_id]").get()),t=JSON.parse(wp.customize("vifewc_sections_params[section_settings]").get()),c=["billing","shipping","order"],n=vifewc_preview_setting.section_disable||[],o="";e.each(i,function(e,i){if(!t[i])return!0;let l="vifewc-section";n.includes(i)&&(l+=" vifewc-section-disabled"),o+='<div class="'+l+'" data-section_id="'+i+'" title="Click to edit fields">',o+='<div class="vifewc-section-title">'+(t[i].name??i)+"</div>",o+='<div class="vifewc-section-actions">',-1===c.indexOf(i)&&(o+='<span class="vifewc-section-edit"><i class="icon edit outline"></i></span>',o+='<span class="vifewc-section-remove"><i class="icon trash alternate outline"></i></span>'),o+="</div></div>"}),e(".vifewc-sections-container").html(o)}),e(document.body).on("vifewc_checkout_section_html",function(i,t=""){let c="",n="",o=vifewc_preview_setting.section_position,l="",d="",s="<h3> Custom name </h3>",a="";if(t){e(".vifewc-section-save").html(vifewc_preview_text.save);let i=JSON.parse(wp.customize("vifewc_sections_params[section_settings]").get());n="vifewc-customize-section-"+t,d=i[t].name||"",s=i[t].title||"",a=i[t].title_color||"",l=i[t].position||"",c+=`<div class="vifewc-customize-section-action"><span class="vifewc-button vifewc-section-remove" title="${vifewc_preview_text.section_action_delete}"><i class="icon trash alternate outline"></i>${vifewc_preview_text.remove}</span>`,c+=`<span class="vifewc-button vifewc-section-edit-fields" title="${vifewc_preview_text.section_action_edit_fields}"><i class="icon edit outline"></i>${vifewc_preview_text.edit}</span></div>`}else t=Date.now(),n="vifewc-customize-section-add_new",e(".vifewc-section-save").html(vifewc_preview_text.add_section);c+=`<div class="vifewc-customize-section-item vifewc-customize-section-show vifewc-customize-section-general ${n}">`,c+=`<div class="vifewc-customize-section-title"><span>${vifewc_preview_text.general_settings_title}</span><i class="dropdown icon"></i></div>`,c+='<div class="vifewc-customize-section-content-wrap">',c+='<div class="vifewc-customize-section-content vifewc-customize-section-content-name">',c+=`<label><span class="customize-control-title">${vifewc_preview_text.section_name}</span></label>`,c+=`<input type="hidden" value="${t}" class="vifewc-customize-section-content-id-value">`,c+=`<input type="text" value="${d}" class="vifewc-customize-section-content-name-value">`,c+="</div>",c+='<div class="vifewc-customize-section-content vifewc-customize-section-content-title">',c+=`<label><span class="customize-control-title">${vifewc_preview_text.section_title}</span></label>`,c+=`<input type="text" value="${s}" class="vifewc-customize-section-content-title-value">`,c+="</div>",c+='<div class="vifewc-customize-section-content vifewc-customize-section-content-name_color">',c+=`<label><span class="customize-control-title">${vifewc_preview_text.section_title_color}</span></label>`,c+=`<input type="text" value="${a}" class="vifewc-color vifewc-customize-section-content-name_color-value">`,c+="</div>",-1===["billing","shipping","order"].indexOf(t)&&(c+='<div class="vifewc-customize-section-content vifewc-customize-section-content-position">',c+=`<label><span class="customize-control-title">${vifewc_preview_text.section_position}</span></label>`,c+='<select class="vifewc-customize-section-content-position-value">',e.each(o,function(e,i){c+='<option value="'+e+'" '+(e===l?"selected":"")+">"+i+"</option>"}),c+="</select>",c+="</div>"),c+="</div>",c+="</div>",e(".vifewc-customize-section").html(c)})});