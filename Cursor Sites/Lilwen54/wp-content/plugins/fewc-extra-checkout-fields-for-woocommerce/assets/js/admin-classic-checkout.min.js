jQuery(document).ready(function(e){"use strict";"undefined"!=typeof vifewc_param&&(e(document).on("click",".vifewc-sections-container .item:not(.active)",function(){let i=e(this).data("tab");i&&("add_new"!==i?e(document).trigger("vifewc_checkout_fields_html",[i]):e(document).trigger("vifewc_checkout_section_html"))}),e(document).on("click",".vifewc-section-remove",function(i){i.preventDefault(),i.stopPropagation();let t=e(this).closest(".item"),n=t.data("tab");n&&confirm(vifewc_param.i18n.section_remove)&&(vifewc_param.section_ids.indexOf(n)>-1&&delete vifewc_param.section_ids[vifewc_param.section_ids.indexOf(n)],vifewc_param.section_settings[n]&&delete vifewc_param.section_settings[n],vifewc_param.section_fields[n]&&delete vifewc_param.section_fields[n],t.hasClass("active")&&e(".vifewc-sections-container .item").eq(0).trigger("click"),t.remove())}),e(document).on("click",".vifewc-section-edit",function(i){i.preventDefault(),i.stopPropagation();let t=e(this).closest(".item").data("tab");t&&e(document).trigger("vifewc_checkout_section_html",[t])}),e(document).on("click",".fewc-edit-section-bt-save",function(){let i=e(this).closest(".fewc-edit-section-container"),t="",n=i.find(".fewc-edit-section-name-value").val(),c=i.find(".fewc-edit-section-id-value").val();if(!n)return e(document.body).trigger("villatheme_show_message",[vifewc_param.i18n.error_name_empty,["error","save-section"],"",!1,4500]),!1;let o=vifewc_param.section_ids,s=vifewc_param.section_settings;o.includes(c)?t=s[c]?.name:o.push(c);let a=e.map(s,function(e){return e.name||""});if(t!=n&&a.includes(n))return e(document.body).trigger("villatheme_show_message",[vifewc_param.i18n.error_name_unique,["error","save-section"],"",!1,4500]),!1;s[c]={name:n,title:i.find(".fewc-edit-section-title-value").val(),title_color:i.find(".fewc-edit-section-title_color-value").val(),position:i.find(".fewc-edit-section-position-value select").val()},vifewc_param.section_ids=o,vifewc_param.section_settings=s,vifewc_param.section_fields[c]||(vifewc_param.section_fields[c]={}),e(".vifewc-sections-container").find('.item[data-tab="'+c+'"]').length?e(".vifewc-sections-container").find('.item[data-tab="'+c+'"]').find(".vifewc-section-title").html(n):(e(".fewc-add-new-section").before(`\n            <div class="item" data-tab="${c}">\n            <div class="vifewc-section">\n                <span class="vifewc-section-title">${n}</span>\n                <div class="vifewc-section-actions">\n                    <span class="vifewc-section-edit"><i class="icon edit outline"></i></span>\n                    <span class="vifewc-section-remove"><i class="icon trash alternate outline"></i></span>\n                </div>\n            </div></div>`),setTimeout(function(i){e(".vifewc-sections-container").find('.item[data-tab="'+i+'"]').trigger("click")},100,c)),i.find(".vifewc-popup-close").trigger("click")}),e(document).on("vifewc_checkout_section_html",function(i,t=""){let n=`<div class="vifewc-popup-wrap fewc-edit-section-container">\n        <div class="vifewc-popup">\n            <div class="vifewc-overlay vifewc-overlay-loading"></div>\n            <div class="vifewc-overlay"></div>\n            <div class="vifewc-popup-container-wrap">\n                <span class="vifewc-popup-close">&#43;</span>\n                <div class="vifewc-popup-container">\n                    <div class="vifewc-popup-header-wrap">${vifewc_param.i18n.add_section_title}</div>\n                    <div class="vifewc-popup-content-wrap">\n                        <div class="vifewc-popup-content-container">\n                            <div class="vifewc-popup-content">\n                                <div class="vifewc-popup-content-horizontal vifewc-popup-content-full-row">\n                                    <div class="vifewc-popup-content-title">${vifewc_param.i18n.section_name}</div>\n                                    <div class="vifewc-popup-content-value">\n                                        <input type="hidden" value="" class="fewc-edit-section-id-value">\n                                        <input type="text" value="" class="fewc-edit-section-name-value">\n                                    </div>\n                                </div>\n                            </div>\n                            <div class="vifewc-popup-content">\n                                <div class="vifewc-popup-content-horizontal vifewc-popup-content-full-row">\n                                    <div class="vifewc-popup-content-title">${vifewc_param.i18n.section_title}</div>\n                                    <div class="vifewc-popup-content-value">\n                                        <input type="text" value="" class="fewc-edit-section-title-value">\n                                    </div>\n                                </div>\n                            </div>\n                            <div class="vifewc-popup-content">\n                                <div class="vifewc-popup-content-horizontal vifewc-popup-content-full-row">\n                                    <div class="vifewc-popup-content-title">${vifewc_param.i18n.section_title_color}</div>\n                                    <div class="vifewc-popup-content-value vifewc-color-value">\n                                        <input type="text" value="" class="vifewc-color fewc-edit-section-title_color-value">\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                    <div class="vifewc-popup-footer-wrap">\n                        <span class="vi-ui button mini primary vifewc-popup-bt fewc-edit-section-bt-save">${vifewc_param.i18n.add_section}</span>\n                    </div>\n                </div>\n            </div>\n        </div>\n        </div>`,c=e(n),o={id:t,name:"",title:"<h3> New section </h3>",title_color:"",position:""};if(t){let e=vifewc_param.section_settings;o.name=e[t].name||"",o.title=e[t].title||"",o.title_color=e[t].title_color||"",o.position=e[t].position||"",c.find(".fewc-edit-section-bt-save").html(vifewc_param.i18n.save),c.find(".fewc-edit-section-container").addClass("fewc-section-"+t+"-wrap")}else o.id=Date.now(),c.find(".fewc-edit-section-container").addClass("fewc-section-add_new-wrap");if(!["billing","shipping","order"].includes(t)){o.position||(o.position="woocommerce_checkout_before_customer_details");let i=e.map(vifewc_param.section_position,function(e,i){return`<option value="${i}">${e}</option>`}),t=`<div class="vifewc-popup-content">\n                            <div class="vifewc-popup-content-horizontal vifewc-popup-content-full-row">\n                                <div class="vifewc-popup-content-title">${vifewc_param.i18n.section_position}</div>\n                                <div class="vifewc-popup-content-value">\n                                    <select class="vi-ui fluid dropdown fewc-edit-section-position-value">${i.join("")}</select>\n                                </div>\n                            </div>\n                        </div>`;c.find(".vifewc-popup-content-container").append(t)}for(let e of Object.keys(o))c.find(`.fewc-edit-section-${e}-value`).val(o[e]).trigger("change");e("body").append(c),setTimeout(function(){e(document).trigger("vifewc_popup_init"),e(".fewc-edit-section-container").removeClass("vifewc-popup-wrap-hidden").addClass("vifewc-popup-wrap-show")},100)}))});